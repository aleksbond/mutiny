<!DOCTYPE HTML>
<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <link rel='stylesheet' href='/site/page.css' />
    <link rel='stylesheet' href='/site/jquery-ui.css' />
    <link rel='stylesheet' href='/site/rainbow.css' />
    <title>Mutiny</title>
  </head>
  <body>
    <nav id='pages'>
      <h1>Pages</h1>
      <a href='/site/jasmine.html'>Jasmine</a>
    </nav>

    <nav id='examples'>
      <h1>Examples</h1>
    </nav>

    <article id='main'></article>

    <script src='/site/jquery.js'></script>
    <script src='/site/jquery-ui.js'></script>
    <script src='/site/page.js'></script>
    <script src='/site/rainbow.min.js'></script>

    <script>
      $.each(Page.widgets, function(i, widget) {
        $('<a href="?%s">%s</a>'.replace(/%s/g, widget)).appendTo('#examples');
      });

      var queryString = window.location.search.replace('?', '');
      if(queryString) {
        $('[href$=' + queryString + ']').addClass('active');
        $('#main').load('/examples/' + queryString + '.html', function() {
          $('#main section').each(function(i, e) {
            var $e = $(e);
            var $pre = $('<pre></pre>').insertBefore($e.find('.example'));
            var $code = $('<code data-language="html"></code>').appendTo($pre);
            /* .html() pulls out the code of the parsed Javascript.  This can cause the
            browser to re-encode ' => " and " => &quot; */
            $code.text($e.find('.example').html().replace(/"/g,      "'")
                                                 .replace(/&quot;/g, '"')
                                                 .replace(/&gt;/g,   '>'));
          });

          Rainbow.color();
          $('#main *').mutiny();
        });
      }
    </script>
  </body>
</html>
